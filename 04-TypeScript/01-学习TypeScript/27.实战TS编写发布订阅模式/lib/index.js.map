{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["interface Evenet {\r\n  on: (name: string, fn: Function) => void;\r\n  emit: (name: string, ...args: Array<any>) => void;\r\n  off: (name: string, fn: Function) => void;\r\n  once: (name: string, fn: Function) => void;\r\n}\r\n\r\ninterface List {\r\n  [key: string]: Array<Function>\r\n}\r\n\r\nclass Dispatch implements Evenet {\r\n  list: List\r\n  constructor() {\r\n    this.list = {}\r\n  }\r\n\r\n  on(name: string, fn: Function) {\r\n    const callback = this.list[name] || []\r\n    callback.push(fn)\r\n    this.list[name] = callback\r\n\r\n  }\r\n\r\n  emit(name: string, ...args: Array<any>) {\r\n    let eventName = this.list[name]\r\n    if (eventName) {\r\n      eventName.forEach(fn => {\r\n        fn.apply(this, args)\r\n      })\r\n    } else {\r\n      console.error(`名称错误${name}`)\r\n    }\r\n  }\r\n\r\n  off(name: string, fn: Function) {\r\n    let eventName = this.list[name]\r\n    if (eventName && fn) {\r\n      // 函数进行比较 删除\r\n      let index = eventName.findIndex(fns => fns === fn)\r\n      eventName.splice(index, 1)\r\n    } else {\r\n      console.error(`名称错误${name}`)\r\n    }\r\n  }\r\n\r\n  once(name: string, fn: Function) {\r\n    // 只调用一次 临时函数 调用订阅$on和派发$emit各一次\r\n    let de = (...args: Array<any>) => {\r\n      fn.apply(this, args)\r\n      this.off(name, de)\r\n    }\r\n    this.on(name, de)\r\n  }\r\n}\r\n\r\nconst o = new Dispatch()\r\n\r\no.on('post', (...args: Array<any>) => {\r\n  console.log(args, 1);\r\n\r\n})\r\n\r\no.once('post', (...args: Array<any>) => {\r\n  console.log(args, 'once');\r\n})\r\n\r\n// const fn = (...args: Array<any>) => {\r\n//   console.log(args, 2);\r\n// }\r\n\r\n// o.on('post', fn)\r\n\r\n// o.off('post', fn)\r\n\r\no.emit('post', 1, false, { name: '小刘' })\r\n\r\no.emit('post', 2, false, { name: '小刘' })\r\n\r\n\r\n"],"names":["o","constructor","this","list","on","name","fn","callback","push","emit","args","eventName","forEach","apply","console","error","off","index","findIndex","fns","splice","once","de","log"],"mappings":"gXAwDA,MAAMA,EAAI,IA7CV,MAEEC,cACEC,KAAKC,KAAO,EACb,CAEDC,GAAGC,EAAcC,GACf,MAAMC,EAAWL,KAAKC,KAAKE,IAAS,GACpCE,EAASC,KAAKF,GACdJ,KAAKC,KAAKE,GAAQE,CAEnB,CAEDE,KAAKJ,KAAiBK,GACpB,IAAIC,EAAYT,KAAKC,KAAKE,GACtBM,EACFA,EAAUC,SAAQN,IAChBA,EAAGO,MAAMX,KAAMQ,EAAK,IAGtBI,QAAQC,MAAM,OAAOV,IAExB,CAEDW,IAAIX,EAAcC,GAChB,IAAIK,EAAYT,KAAKC,KAAKE,GAC1B,GAAIM,GAAaL,EAAI,CAEnB,IAAIW,EAAQN,EAAUO,WAAUC,GAAOA,IAAQb,IAC/CK,EAAUS,OAAOH,EAAO,EACzB,MACCH,QAAQC,MAAM,OAAOV,IAExB,CAEDgB,KAAKhB,EAAcC,GAEjB,IAAIgB,EAAK,IAAIZ,KACXJ,EAAGO,MAAMX,KAAMQ,GACfR,KAAKc,IAAIX,EAAMiB,EAAG,EAEpBpB,KAAKE,GAAGC,EAAMiB,EACf,GAKHtB,EAAEI,GAAG,QAAQ,IAAIM,KACfI,QAAQS,IAAIb,EAAM,EAAE,IAItBV,EAAEqB,KAAK,QAAQ,IAAIX,KACjBI,QAAQS,IAAIb,EAAM,OAAO,IAW3BV,EAAES,KAAK,OAAQ,GAAG,EAAO,CAAEJ,KAAM,OAEjCL,EAAES,KAAK,OAAQ,GAAG,EAAO,CAAEJ,KAAM"}